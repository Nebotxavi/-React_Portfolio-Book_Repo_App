{"ast":null,"code":"import _objectSpread from \"/home/balaclava/Desktop/Javascript/react/100daysCode/01-Book_system/front_book_repo/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nvar _jsxFileName = \"/home/balaclava/Desktop/Javascript/react/100daysCode/01-Book_system/front_book_repo/src/components/common/form.jsx\";\nimport React, { useContext } from \"react\";\nimport Joi from \"joi-browser\";\nimport Input from \"./input\"; // import Select from \"./select\";\n\nimport { ThemeContext } from \"../registerForm\";\n\nconst Form = () => {\n  function validate(data, schema) {\n    const options = {\n      abortEarly: false\n    };\n\n    const _Joi$validate = Joi.validate(data, schema, options),\n          error = _Joi$validate.error;\n\n    if (!error) return null;\n    const errors = {};\n\n    for (let item of error.details) errors[item.path[0]] = item.message;\n\n    return errors;\n  }\n\n  function validateProperty({\n    name,\n    value\n  }, schema) {\n    const obj = {\n      [name]: value\n    };\n    const propertySchema = {\n      [name]: schema[name]\n    };\n\n    const _Joi$validate2 = Joi.validate(obj, propertySchema),\n          error = _Joi$validate2.error;\n\n    return error ? error.details[0].message : null;\n  }\n\n  function handleChange({\n    currentTarget: input\n  }, errors, setErrors, data, setData, schema) {\n    const allErrors = errors;\n    const errorMessage = validateProperty(input, schema);\n    if (errorMessage) allErrors[input.name] = errorMessage;else delete allErrors[input.name];\n    setErrors(allErrors);\n    setData(_objectSpread({}, data, {\n      [input.name]: input.value\n    }));\n  }\n\n  function handleSubmit(e, setErrors, data, schema, doSubmit) {\n    e.preventDefault();\n    const errors = validate(data, schema);\n    setErrors(errors || {});\n    if (errors) return;\n    doSubmit();\n  }\n\n  function renderButton(label, data, schema) {\n    return React.createElement(\"button\", {\n      type: \"submit\",\n      className: \"btn btn-primary\",\n      disabled: validate(data, schema),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56\n      },\n      __self: this\n    }, label);\n  } //   function renderSelect(name, label) {\n  //     return (\n  //       <Select\n  //         name={name}\n  //         label={label}\n  //         options={genres}\n  //         item={book}\n  //         setItem={setBook}\n  //         handleChange={handleChange}\n  //         error={errors[name]}\n  //       />\n  //     );\n  //   }\n\n\n  function renderInput(name, label, data, setData, errors, setErrors, schema, type = \"text\") {\n    // const context = useContext(ThemeContext);\n    console.log(context);\n    return React.createElement(Input, {\n      name: name,\n      label: label,\n      type: type,\n      item: data,\n      setItem: setData,\n      handleChange: e => handleChange(e, errors, setErrors, data, setData, schema),\n      error: errors[name],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    });\n  }\n\n  return;\n};\n\nexport default Form;","map":{"version":3,"sources":["/home/balaclava/Desktop/Javascript/react/100daysCode/01-Book_system/front_book_repo/src/components/common/form.jsx"],"names":["React","useContext","Joi","Input","ThemeContext","Form","validate","data","schema","options","abortEarly","error","errors","item","details","path","message","validateProperty","name","value","obj","propertySchema","handleChange","currentTarget","input","setErrors","setData","allErrors","errorMessage","handleSubmit","e","doSubmit","preventDefault","renderButton","label","renderInput","type","console","log","context"],"mappings":"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","sourcesContent":["import React, { useContext } from \"react\";\nimport Joi from \"joi-browser\";\n\nimport Input from \"./input\";\n// import Select from \"./select\";\nimport { ThemeContext } from \"../registerForm\";\n\nconst Form = () => {\n  function validate(data, schema) {\n    const options = { abortEarly: false };\n    const { error } = Joi.validate(data, schema, options);\n    if (!error) return null;\n\n    const errors = {};\n    for (let item of error.details) errors[item.path[0]] = item.message;\n    return errors;\n  }\n\n  function validateProperty({ name, value }, schema) {\n    const obj = { [name]: value };\n    const propertySchema = { [name]: schema[name] };\n    const { error } = Joi.validate(obj, propertySchema);\n\n    return error ? error.details[0].message : null;\n  }\n\n  function handleChange(\n    { currentTarget: input },\n    errors,\n    setErrors,\n    data,\n    setData,\n    schema\n  ) {\n    const allErrors = errors;\n    const errorMessage = validateProperty(input, schema);\n    if (errorMessage) allErrors[input.name] = errorMessage;\n    else delete allErrors[input.name];\n\n    setErrors(allErrors);\n    setData({ ...data, [input.name]: input.value });\n  }\n\n  function handleSubmit(e, setErrors, data, schema, doSubmit) {\n    e.preventDefault();\n\n    const errors = validate(data, schema);\n    setErrors(errors || {});\n    if (errors) return;\n\n    doSubmit();\n  }\n\n  function renderButton(label, data, schema) {\n    return (\n      <button\n        type=\"submit\"\n        className=\"btn btn-primary\"\n        disabled={validate(data, schema)}\n      >\n        {label}\n      </button>\n    );\n  }\n\n  //   function renderSelect(name, label) {\n  //     return (\n  //       <Select\n  //         name={name}\n  //         label={label}\n  //         options={genres}\n  //         item={book}\n  //         setItem={setBook}\n  //         handleChange={handleChange}\n  //         error={errors[name]}\n  //       />\n  //     );\n  //   }\n\n  function renderInput(\n    name,\n    label,\n    data,\n    setData,\n    errors,\n    setErrors,\n    schema,\n    type = \"text\"\n  ) {\n    // const context = useContext(ThemeContext);\n    console.log(context);\n    return (\n      <Input\n        name={name}\n        label={label}\n        type={type}\n        item={data}\n        setItem={setData}\n        handleChange={e =>\n          handleChange(e, errors, setErrors, data, setData, schema)\n        }\n        error={errors[name]}\n      />\n    );\n  }\n  return;\n};\n\nexport default Form;\n"]},"metadata":{},"sourceType":"module"}