{"ast":null,"code":"import _objectSpread from \"/home/balaclava/Desktop/Javascript/react/100daysCode/01-Book_system/front_book_repo/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nvar _jsxFileName = \"/home/balaclava/Desktop/Javascript/react/100daysCode/01-Book_system/front_book_repo/src/components/common/form.jsx\";\nimport React, { useState } from \"react\";\nimport Joi from \"joi-browser\";\nimport Input from \"./input\";\nimport Select from \"./select\";\n\nconst Form = ({\n  inputList,\n  data,\n  setData,\n  errors,\n  setErrors,\n  genres,\n  schema,\n  doSubmit\n}) => {\n  const validate = () => {\n    const options = {\n      abortEarly: false\n    };\n\n    const _Joi$validate = Joi.validate(data, schema, options),\n          error = _Joi$validate.error;\n\n    if (!error) return null;\n    const errors = {};\n\n    for (let item of error.details) errors[item.path[0]] = item.message;\n\n    return errors;\n  };\n\n  const validateProperty = ({\n    name,\n    value\n  }) => {\n    const obj = {\n      [name]: value\n    };\n    const propertySchema = {\n      [name]: schema[name]\n    };\n\n    const _Joi$validate2 = Joi.validate(obj, propertySchema),\n          error = _Joi$validate2.error;\n\n    return error ? error.details[0].message : null;\n  };\n\n  const handleChange = ({\n    currentTarget: input\n  }) => {\n    const allErrors = errors;\n    const errorMessage = validateProperty(input);\n    if (errorMessage) allErrors[input.name] = errorMessage;else delete allErrors[input.name];\n    setErrors(allErrors);\n    setData(_objectSpread({}, data, {\n      [input.name]: input.value\n    }));\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    const errors = validate();\n    setErrors(errors || {});\n    if (errors) return;\n    doSubmit();\n  };\n\n  const renderButton = label => {\n    return React.createElement(\"button\", {\n      type: \"submit\",\n      key: label,\n      className: \"btn btn-primary\",\n      disabled: validate(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57\n      },\n      __self: this\n    }, label);\n  };\n\n  const renderElement = ({\n    name,\n    label,\n    value,\n    type,\n    element\n  }) => {\n    if (element === \"Input\") return React.createElement(Input, {\n      name: name,\n      label: label,\n      type: type,\n      value: value,\n      error: errors[name],\n      key: name,\n      handleChange: handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    });else if (element === \"Select\") return React.createElement(Select, {\n      name: name,\n      label: label,\n      value: value,\n      options: genres,\n      error: errors[name],\n      key: name,\n      handleChange: handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    });else return renderButton(label);\n  };\n\n  return React.createElement(\"form\", {\n    action: \"\",\n    onSubmit: handleSubmit,\n    className: \"bookForm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }, inputList.map(inputs => renderElement(inputs)));\n};\n\nexport default Form;","map":{"version":3,"sources":["/home/balaclava/Desktop/Javascript/react/100daysCode/01-Book_system/front_book_repo/src/components/common/form.jsx"],"names":["React","useState","Joi","Input","Select","Form","inputList","data","setData","errors","setErrors","genres","schema","doSubmit","validate","options","abortEarly","error","item","details","path","message","validateProperty","name","value","obj","propertySchema","handleChange","currentTarget","input","allErrors","errorMessage","handleSubmit","e","preventDefault","renderButton","label","renderElement","type","element","map","inputs"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport Joi from \"joi-browser\";\n\nimport Input from \"./input\";\nimport Select from \"./select\";\n\nconst Form = ({\n  inputList,\n  data,\n  setData,\n  errors,\n  setErrors,\n  genres,\n  schema,\n  doSubmit\n}) => {\n  const validate = () => {\n    const options = { abortEarly: false };\n    const { error } = Joi.validate(data, schema, options);\n    if (!error) return null;\n\n    const errors = {};\n    for (let item of error.details) errors[item.path[0]] = item.message;\n    return errors;\n  };\n\n  const validateProperty = ({ name, value }) => {\n    const obj = { [name]: value };\n    const propertySchema = { [name]: schema[name] };\n    const { error } = Joi.validate(obj, propertySchema);\n\n    return error ? error.details[0].message : null;\n  };\n\n  const handleChange = ({ currentTarget: input }) => {\n    const allErrors = errors;\n    const errorMessage = validateProperty(input);\n    if (errorMessage) allErrors[input.name] = errorMessage;\n    else delete allErrors[input.name];\n\n    setErrors(allErrors);\n    setData({ ...data, [input.name]: input.value });\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n\n    const errors = validate();\n    setErrors(errors || {});\n    if (errors) return;\n\n    doSubmit();\n  };\n\n  const renderButton = label => {\n    return (\n      <button\n        type=\"submit\"\n        key={label}\n        className=\"btn btn-primary\"\n        disabled={validate()}\n      >\n        {label}\n      </button>\n    );\n  };\n\n  const renderElement = ({ name, label, value, type, element }) => {\n    if (element === \"Input\")\n      return (\n        <Input\n          name={name}\n          label={label}\n          type={type}\n          value={value}\n          error={errors[name]}\n          key={name}\n          handleChange={handleChange}\n        />\n      );\n    else if (element === \"Select\")\n      return (\n        <Select\n          name={name}\n          label={label}\n          value={value}\n          options={genres}\n          error={errors[name]}\n          key={name}\n          handleChange={handleChange}\n        />\n      );\n    else return renderButton(label);\n  };\n\n  return (\n    <form action=\"\" onSubmit={handleSubmit} className=\"bookForm\">\n      {inputList.map(inputs => renderElement(inputs))}\n    </form>\n  );\n};\n\nexport default Form;\n"]},"metadata":{},"sourceType":"module"}