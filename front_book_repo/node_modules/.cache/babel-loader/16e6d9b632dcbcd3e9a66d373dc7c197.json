{"ast":null,"code":"import _objectSpread from \"/home/balaclava/Desktop/Javascript/react/100daysCode/01-Book_system/front_book_repo/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nvar _jsxFileName = \"/home/balaclava/Desktop/Javascript/react/100daysCode/01-Book_system/front_book_repo/src/components/common/form.jsx\";\nimport React from \"react\";\nimport Joi from \"joi-browser\";\nimport Input from \"./input\"; // import Select from \"./select\";\n\nconst Form = ({\n  inputList,\n  data,\n  setData,\n  errors,\n  setErrors,\n  schema\n}) => {\n  const validate = () => {\n    const options = {\n      abortEarly: false\n    };\n\n    const _Joi$validate = Joi.validate(data, schema, options),\n          error = _Joi$validate.error;\n\n    if (!error) return null;\n    const errors = {};\n\n    for (let item of error.details) errors[item.path[0]] = item.message;\n\n    return errors;\n  };\n\n  const validateProperty = ({\n    name,\n    value\n  }) => {\n    const obj = {\n      [name]: value\n    };\n    const propertySchema = {\n      [name]: schema[name]\n    };\n\n    const _Joi$validate2 = Joi.validate(obj, propertySchema),\n          error = _Joi$validate2.error;\n\n    return error ? error.details[0].message : null;\n  };\n\n  const handleChange = ({\n    currentTarget: input\n  }) => {\n    console.log(\"into handleChange\");\n    const allErrors = errors;\n    const errorMessage = validateProperty(input, schema);\n    if (errorMessage) allErrors[input.name] = errorMessage;else delete allErrors[input.name];\n    setErrors(allErrors);\n    setData(_objectSpread({}, data, {\n      [input.name]: input.value\n    }));\n  };\n\n  const handleSubmit = (e, doSubmit) => {\n    e.preventDefault();\n    const errors = validate(data, schema);\n    setErrors(errors || {});\n    if (errors) return;\n    doSubmit();\n  }; // const renderButton = (label, data, schema) => {\n  //   return (\n  //     <button\n  //       type=\"submit\"\n  //       className=\"btn btn-primary\"\n  //       disabled={validate(data, schema)}\n  //     >\n  //       {label}\n  //     </button>\n  //   );\n  // };\n  //    function renderSelect(name, label) {\n  //     return (\n  //       <Select\n  //         name={name}\n  //         label={label}\n  //         options={genres}\n  //         item={book}\n  //         setItem={setBook}\n  //         handleChange={handleChange}\n  //         error={errors[name]}\n  //       />\n  //     );\n  //   }\n  // const renderInput = (\n  //   name,\n  //   label,\n  //   data,\n  //   setData,\n  //   errors,\n  //   setErrors,\n  //   schema,\n  //   type = \"text\"\n  // ) => {\n  //   return (\n  //     <Input\n  //       name={name}\n  //       label={label}\n  //       type={type}\n  //       item={data}\n  //       setItem={setData}\n  //       handleChange={e =>\n  //         handleChange(e, errors, setErrors, data, setData, schema)\n  //       }\n  //       error={errors[name]}\n  //     />\n  //   );\n  // };\n\n\n  return React.createElement(\"form\", {\n    action: \"\",\n    onSubmit: handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  }, inputList.map(({\n    name,\n    label,\n    value,\n    type = \"text\"\n  }) => React.createElement(Input, {\n    name: name,\n    type: type,\n    value: value,\n    label: label,\n    onChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  })));\n};\n\nexport default Form;","map":{"version":3,"sources":["/home/balaclava/Desktop/Javascript/react/100daysCode/01-Book_system/front_book_repo/src/components/common/form.jsx"],"names":["React","Joi","Input","Form","inputList","data","setData","errors","setErrors","schema","validate","options","abortEarly","error","item","details","path","message","validateProperty","name","value","obj","propertySchema","handleChange","currentTarget","input","console","log","allErrors","errorMessage","handleSubmit","e","doSubmit","preventDefault","map","label","type"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,GAAP,MAAgB,aAAhB;AAEA,OAAOC,KAAP,MAAkB,SAAlB,C,CACA;;AAEA,MAAMC,IAAI,GAAG,CAAC;AAAEC,EAAAA,SAAF;AAAaC,EAAAA,IAAb;AAAmBC,EAAAA,OAAnB;AAA4BC,EAAAA,MAA5B;AAAoCC,EAAAA,SAApC;AAA+CC,EAAAA;AAA/C,CAAD,KAA6D;AACxE,QAAMC,QAAQ,GAAG,MAAM;AACrB,UAAMC,OAAO,GAAG;AAAEC,MAAAA,UAAU,EAAE;AAAd,KAAhB;;AADqB,0BAEHX,GAAG,CAACS,QAAJ,CAAaL,IAAb,EAAmBI,MAAnB,EAA2BE,OAA3B,CAFG;AAAA,UAEbE,KAFa,iBAEbA,KAFa;;AAGrB,QAAI,CAACA,KAAL,EAAY,OAAO,IAAP;AAEZ,UAAMN,MAAM,GAAG,EAAf;;AACA,SAAK,IAAIO,IAAT,IAAiBD,KAAK,CAACE,OAAvB,EAAgCR,MAAM,CAACO,IAAI,CAACE,IAAL,CAAU,CAAV,CAAD,CAAN,GAAuBF,IAAI,CAACG,OAA5B;;AAChC,WAAOV,MAAP;AACD,GARD;;AAUA,QAAMW,gBAAgB,GAAG,CAAC;AAAEC,IAAAA,IAAF;AAAQC,IAAAA;AAAR,GAAD,KAAqB;AAC5C,UAAMC,GAAG,GAAG;AAAE,OAACF,IAAD,GAAQC;AAAV,KAAZ;AACA,UAAME,cAAc,GAAG;AAAE,OAACH,IAAD,GAAQV,MAAM,CAACU,IAAD;AAAhB,KAAvB;;AAF4C,2BAG1BlB,GAAG,CAACS,QAAJ,CAAaW,GAAb,EAAkBC,cAAlB,CAH0B;AAAA,UAGpCT,KAHoC,kBAGpCA,KAHoC;;AAK5C,WAAOA,KAAK,GAAGA,KAAK,CAACE,OAAN,CAAc,CAAd,EAAiBE,OAApB,GAA8B,IAA1C;AACD,GAND;;AAQA,QAAMM,YAAY,GAAG,CAAC;AAAEC,IAAAA,aAAa,EAAEC;AAAjB,GAAD,KAA8B;AACjDC,IAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ;AACA,UAAMC,SAAS,GAAGrB,MAAlB;AACA,UAAMsB,YAAY,GAAGX,gBAAgB,CAACO,KAAD,EAAQhB,MAAR,CAArC;AACA,QAAIoB,YAAJ,EAAkBD,SAAS,CAACH,KAAK,CAACN,IAAP,CAAT,GAAwBU,YAAxB,CAAlB,KACK,OAAOD,SAAS,CAACH,KAAK,CAACN,IAAP,CAAhB;AAELX,IAAAA,SAAS,CAACoB,SAAD,CAAT;AACAtB,IAAAA,OAAO,mBAAMD,IAAN;AAAY,OAACoB,KAAK,CAACN,IAAP,GAAcM,KAAK,CAACL;AAAhC,OAAP;AACD,GATD;;AAWA,QAAMU,YAAY,GAAG,CAACC,CAAD,EAAIC,QAAJ,KAAiB;AACpCD,IAAAA,CAAC,CAACE,cAAF;AAEA,UAAM1B,MAAM,GAAGG,QAAQ,CAACL,IAAD,EAAOI,MAAP,CAAvB;AACAD,IAAAA,SAAS,CAACD,MAAM,IAAI,EAAX,CAAT;AACA,QAAIA,MAAJ,EAAY;AAEZyB,IAAAA,QAAQ;AACT,GARD,CA9BwE,CAwCxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,SACE;AAAM,IAAA,MAAM,EAAC,EAAb;AAAgB,IAAA,QAAQ,EAAEF,YAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG1B,SAAS,CAAC8B,GAAV,CAAc,CAAC;AAAEf,IAAAA,IAAF;AAAQgB,IAAAA,KAAR;AAAef,IAAAA,KAAf;AAAsBgB,IAAAA,IAAI,GAAG;AAA7B,GAAD,KACb,oBAAC,KAAD;AACE,IAAA,IAAI,EAAEjB,IADR;AAEE,IAAA,IAAI,EAAEiB,IAFR;AAGE,IAAA,KAAK,EAAEhB,KAHT;AAIE,IAAA,KAAK,EAAEe,KAJT;AAKE,IAAA,QAAQ,EAAEZ,YALZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,CADH,CADF;AAaD,CAxGD;;AA0GA,eAAepB,IAAf","sourcesContent":["import React from \"react\";\nimport Joi from \"joi-browser\";\n\nimport Input from \"./input\";\n// import Select from \"./select\";\n\nconst Form = ({ inputList, data, setData, errors, setErrors, schema }) => {\n  const validate = () => {\n    const options = { abortEarly: false };\n    const { error } = Joi.validate(data, schema, options);\n    if (!error) return null;\n\n    const errors = {};\n    for (let item of error.details) errors[item.path[0]] = item.message;\n    return errors;\n  };\n\n  const validateProperty = ({ name, value }) => {\n    const obj = { [name]: value };\n    const propertySchema = { [name]: schema[name] };\n    const { error } = Joi.validate(obj, propertySchema);\n\n    return error ? error.details[0].message : null;\n  };\n\n  const handleChange = ({ currentTarget: input }) => {\n    console.log(\"into handleChange\");\n    const allErrors = errors;\n    const errorMessage = validateProperty(input, schema);\n    if (errorMessage) allErrors[input.name] = errorMessage;\n    else delete allErrors[input.name];\n\n    setErrors(allErrors);\n    setData({ ...data, [input.name]: input.value });\n  };\n\n  const handleSubmit = (e, doSubmit) => {\n    e.preventDefault();\n\n    const errors = validate(data, schema);\n    setErrors(errors || {});\n    if (errors) return;\n\n    doSubmit();\n  };\n\n  // const renderButton = (label, data, schema) => {\n  //   return (\n  //     <button\n  //       type=\"submit\"\n  //       className=\"btn btn-primary\"\n  //       disabled={validate(data, schema)}\n  //     >\n  //       {label}\n  //     </button>\n  //   );\n  // };\n\n  //    function renderSelect(name, label) {\n  //     return (\n  //       <Select\n  //         name={name}\n  //         label={label}\n  //         options={genres}\n  //         item={book}\n  //         setItem={setBook}\n  //         handleChange={handleChange}\n  //         error={errors[name]}\n  //       />\n  //     );\n  //   }\n\n  // const renderInput = (\n  //   name,\n  //   label,\n  //   data,\n  //   setData,\n  //   errors,\n  //   setErrors,\n  //   schema,\n  //   type = \"text\"\n  // ) => {\n  //   return (\n  //     <Input\n  //       name={name}\n  //       label={label}\n  //       type={type}\n  //       item={data}\n  //       setItem={setData}\n  //       handleChange={e =>\n  //         handleChange(e, errors, setErrors, data, setData, schema)\n  //       }\n  //       error={errors[name]}\n  //     />\n  //   );\n  // };\n\n  return (\n    <form action=\"\" onSubmit={handleSubmit}>\n      {inputList.map(({ name, label, value, type = \"text\" }) => (\n        <Input\n          name={name}\n          type={type}\n          value={value}\n          label={label}\n          onChange={handleChange}\n        />\n      ))}\n    </form>\n  );\n};\n\nexport default Form;\n"]},"metadata":{},"sourceType":"module"}